<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ë–∞–π—Ç –ö–æ–¥–∞: –ö—Ä—É–∂–æ–∫ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }
        
        :root {
            --tg-bg: #17212b;
            --tg-header: #1e2b36;
            --tg-message: #1e2b36;
            --tg-own: #2b5278;
            --tg-border: #2b3a45;
            --tg-text: #fff;
            --tg-secondary: #8e9ca8;
            --tg-accent: #6ab2f2;
        }
        
        body {
            background: var(--tg-bg);
            color: var(--tg-text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            transition: all 0.3s;
        }
        
        /* –ì–ª—é–∫-—Ç–µ–º—ã */
        body.glitch-mode {
            --tg-bg: #0a0a0a;
            --tg-header: #1a1a1a;
            --tg-message: #1a1a1a;
            --tg-border: #ff0000;
            --tg-accent: #ff6b6b;
            animation: screenGlitch 0.2s infinite;
        }
        
        @keyframes screenGlitch {
            0% { transform: translate(0); filter: hue-rotate(0deg); }
            20% { transform: translate(-2px, 2px); filter: hue-rotate(90deg); }
            40% { transform: translate(2px, -2px); filter: hue-rotate(180deg); }
            60% { transform: translate(-1px, 1px); filter: hue-rotate(270deg); }
            80% { transform: translate(1px, -1px); filter: hue-rotate(360deg); }
            100% { transform: translate(0); filter: hue-rotate(0deg); }
        }
        
        /* Telegram Header */
        .tg-header {
            background: var(--tg-header);
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid var(--tg-border);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .back-btn {
            color: var(--tg-accent);
            font-size: 24px;
            line-height: 1;
            text-decoration: none;
            cursor: pointer;
        }
        
        .header-title {
            font-weight: 600;
            font-size: 17px;
            flex: 1;
        }
        
        .menu-btn {
            color: var(--tg-accent);
            font-size: 20px;
            cursor: pointer;
        }
        
        /* –ê–≤–∞—Ç–∞—Ä–∫–∏ */
        .members-bar {
            display: flex;
            gap: 16px;
            padding: 12px 16px;
            background: var(--tg-header);
            border-bottom: 1px solid var(--tg-border);
            overflow-x: auto;
        }
        
        .member {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            min-width: 60px;
        }
        
        .avatar {
            width: 52px;
            height: 52px;
            border-radius: 50%;
            background: var(--tg-border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            transition: all 0.3s;
            position: relative;
        }
        
        .avatar.bingus-glitch {
            animation: avatarGlitch 0.5s infinite;
        }
        
        @keyframes avatarGlitch {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(5deg) scale(1.1); }
            50% { transform: rotate(-5deg) scale(0.9); }
            75% { transform: rotate(3deg); }
            100% { transform: rotate(0deg); }
        }
        
        .member-name {
            font-size: 12px;
            color: var(--tg-secondary);
        }
        
        .online-badge {
            width: 8px;
            height: 8px;
            background: #00ff00;
            border-radius: 50%;
            position: absolute;
            bottom: 2px;
            right: 2px;
        }
        
        /* –ß–∞—Ç */
        .chat-container {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
            min-height: 60vh;
        }
        
        .message {
            display: flex;
            gap: 8px;
            max-width: 85%;
            opacity: 1;
            transition: opacity 0.3s;
        }
        
        .message.deleted {
            opacity: 0.3;
            filter: blur(1px);
        }
        
        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--tg-border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .message-content {
            background: var(--tg-message);
            padding: 8px 12px;
            border-radius: 12px 12px 12px 4px;
            word-break: break-word;
        }
        
        .own-message .message-content {
            background: var(--tg-own);
            border-radius: 12px 12px 4px 12px;
        }
        
        .message-name {
            font-weight: 600;
            font-size: 13px;
            margin-bottom: 4px;
            color: var(--tg-accent);
        }
        
        .own-message .message-name {
            color: #fff;
            text-align: right;
        }
        
        .message-text {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .message-time {
            font-size: 11px;
            color: var(--tg-secondary);
            margin-top: 4px;
            text-align: right;
        }
        
        .code-block {
            background: #0f1a24;
            padding: 12px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin: 8px 0;
            border-left: 3px solid var(--tg-accent);
        }
        
        .image-message {
            max-width: 200px;
            border-radius: 12px;
            margin: 4px 0;
            cursor: pointer;
        }
        
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 12px 16px;
            background: var(--tg-message);
            border-radius: 20px;
            width: fit-content;
            margin-left: 52px;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--tg-secondary);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }
        
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typing {
            0%, 60%, 100% { opacity: 0.3; transform: translateY(0); }
            30% { opacity: 1; transform: translateY(-4px); }
        }
        
        /* –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å */
        .input-area {
            padding: 16px;
            background: var(--tg-header);
            border-top: 1px solid var(--tg-border);
            position: sticky;
            bottom: 0;
        }
        
        .button {
            background: var(--tg-accent);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 10px;
            font-weight: 600;
            font-size: 16px;
            width: 100%;
            margin-bottom: 8px;
            cursor: pointer;
            transition: 0.2s;
        }
        
        .button:active {
            transform: scale(0.98);
        }
        
        .button.secondary {
            background: var(--tg-border);
        }
        
        .button.danger {
            background: #b52b2b;
        }
        
        .button.hidden {
            display: none;
        }
        
        .quick-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 8px;
        }
        
        /* –°–∏–Ω–∏–π —ç–∫—Ä–∞–Ω */
        .bsod {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0000aa;
            color: white;
            font-family: 'Courier New', monospace;
            padding: 20px;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            animation: bsodFlicker 2s infinite;
        }
        
        @keyframes bsodFlicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.9; background: #000088; }
        }
        
        .bsod pre {
            font-size: 14px;
            line-height: 1.5;
        }
        
        .bsod.hidden {
            display: none;
        }
        
        /* –ú–µ–Ω—é */
        .menu-panel {
            position: fixed;
            top: 0;
            right: -100%;
            width: 80%;
            height: 100%;
            background: var(--tg-header);
            border-left: 1px solid var(--tg-border);
            transition: right 0.3s;
            z-index: 1000;
            padding: 60px 20px 20px;
        }
        
        .menu-panel.open {
            right: 0;
        }
        
        .menu-item {
            padding: 16px;
            border-bottom: 1px solid var(--tg-border);
            cursor: pointer;
        }
        
        /* –ö–∞–º–µ—Ä–∞ */
        .camera-preview {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: black;
            z-index: 3000;
            display: flex;
            flex-direction: column;
        }
        
        .camera-preview video {
            width: 100%;
            height: 80%;
            object-fit: cover;
        }
        
        .camera-controls {
            display: flex;
            gap: 16px;
            padding: 20px;
            justify-content: center;
        }
        
        /* –§–æ—Ç–æ –≤ —á–∞—Ç–µ */
        .photo-message {
            max-width: 200px;
            border-radius: 12px;
            margin: 4px 0;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .photo-message.glitch {
            border-color: #ff0000;
            filter: hue-rotate(180deg);
        }
        
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Telegram Header -->
    <div class="tg-header">
        <div class="back-btn" onclick="closeApp()">‚Üê</div>
        <div class="header-title" id="headerTitle">–ò–Ω—Ñ–æ–ö–æ—Ç—ã ‚Ä¢ –î–µ–Ω—å 1</div>
        <div class="menu-btn" onclick="toggleMenu()">‚ãØ</div>
    </div>
    
    <!-- –ú–µ–Ω—é -->
    <div class="menu-panel" id="menuPanel">
        <div class="menu-item" onclick="showSettings()">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
        <div class="menu-item" onclick="showGallery()">üñºÔ∏è –ì–∞–ª–µ—Ä–µ—è</div>
        <div class="menu-item" onclick="showAbout()">üìú –û –∏–≥—Ä–µ</div>
        <div class="menu-item" onclick="deleteSave()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</div>
        <div class="menu-item" onclick="toggleMenu()">‚úñÔ∏è –ó–∞–∫—Ä—ã—Ç—å</div>
    </div>
    
    <!-- –ê–≤–∞—Ç–∞—Ä–∫–∏ -->
    <div class="members-bar" id="membersBar">
        <div class="member" onclick="showProfile('shlypa')">
            <div class="avatar" id="avatarShlypa">üò∫</div>
            <span class="member-name">–®–ª—ë–ø–∞</span>
        </div>
        <div class="member" onclick="showProfile('bingus')">
            <div class="avatar" id="avatarBingus">üòø</div>
            <span class="member-name">–ë–∏–Ω–≥—É—Å</span>
        </div>
        <div class="member" onclick="showProfile('popcat')">
            <div class="avatar" id="avatarPopcat">üò∏</div>
            <span class="member-name">–ü–æ–ø–∫—ç—Ç</span>
        </div>
    </div>
    
    <!-- –ß–∞—Ç -->
    <div class="chat-container" id="chat"></div>
    
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏ -->
    <div class="typing-indicator hidden" id="typingIndicator">
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
    </div>
    
    <!-- –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å -->
    <div class="input-area" id="inputArea">
        <button class="button" id="actionButton1" onclick="handleAction1()"></button>
        <button class="button secondary" id="actionButton2" onclick="handleAction2()"></button>
        <div class="quick-actions" id="quickActions"></div>
    </div>
    
    <!-- –°–∏–Ω–∏–π —ç–∫—Ä–∞–Ω -->
    <div class="bsod hidden" id="bsod">
        <pre>
A problem has been detected...
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  BINGUS_IS_SAD                       ‚ïë
‚ïë  SHLYPA_OVERHEAT                      ‚ïë
‚ïë  POPCAT_LOOP                           ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

Technical information:
*** STOP: 0x000000FEED (0x00000000, 0x00000000, 0x00000000, 0x00000000)

*** shlypa.sys - Address 0xFEEDBEEF base at 0xBA5EBA11, DateStamp 3:15:00

Press any key to continue...
        </pre>
    </div>
    
    <!-- –ö–∞–º–µ—Ä–∞ -->
    <div class="camera-preview hidden" id="cameraPreview">
        <video id="cameraVideo" autoplay playsinline></video>
        <div class="camera-controls">
            <button class="button" onclick="takePhoto()">üì∏ –°–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ</button>
            <button class="button secondary" onclick="closeCamera()">‚úñÔ∏è –ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø TELEGRAM ==========
        let tg = window.Telegram?.WebApp;
        if (tg) {
            tg.expand();
            tg.enableClosingConfirmation();
            tg.setHeaderColor('#1e2b36');
            tg.setBackgroundColor('#17212b');
        }
        
        // ========== –°–û–•–†–ê–ù–ï–ù–ò–Ø ==========
        const SAVE_KEY = 'bytecode_save';
        
        let gameState = {
            day: 1,
            choice: null,
            messages: [],
            bingusTrust: 0,
            popcatLoop: 0,
            shlypaCookies: 0,
            glitchLevel: 0,
            photos: [],
            cameraUsed: false,
            lastSave: new Date().toISOString(),
            yujinFound: false
        };
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        function loadGame() {
            try {
                const saved = localStorage.getItem(SAVE_KEY);
                if (saved) {
                    const parsed = JSON.parse(saved);
                    gameState = {...gameState, ...parsed};
                    
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
                    chatEl.innerHTML = '';
                    gameState.messages.forEach(msg => {
                        displayMessage(msg.sender, msg.text, msg.isOwn, false);
                    });
                    
                    updateDay();
                    return true;
                }
            } catch (e) {
                console.log('No save or error');
            }
            return false;
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        function saveGame() {
            gameState.lastSave = new Date().toISOString();
            localStorage.setItem(SAVE_KEY, JSON.stringify(gameState));
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É –¥–ª—è –ø—É—à–µ–π
            if (tg) {
                tg.sendData(JSON.stringify({
                    action: 'save',
                    day: gameState.day,
                    user: tg.initDataUnsafe?.user?.id
                }));
            }
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        function deleteSave() {
            if (confirm('–¢–æ—á–Ω–æ —É–¥–∞–ª–∏—Ç—å? –ë–∏–Ω–≥—É—Å –±—É–¥–µ—Ç –≥—Ä—É—Å—Ç–∏—Ç—å...')) {
                localStorage.removeItem(SAVE_KEY);
                gameState = {
                    day: 1,
                    choice: null,
                    messages: [],
                    bingusTrust: 0,
                    popcatLoop: 0,
                    shlypaCookies: 0,
                    glitchLevel: 0,
                    photos: [],
                    cameraUsed: false,
                    lastSave: new Date().toISOString()
                };
                chatEl.innerHTML = '';
                startDay1();
                toggleMenu();
            }
        }
        
        // ========== –≠–õ–ï–ú–ï–ù–¢–´ DOM ==========
        const chatEl = document.getElementById('chat');
        const typingIndicator = document.getElementById('typingIndicator');
        const bsodEl = document.getElementById('bsod');
        const cameraPreview = document.getElementById('cameraPreview');
        const cameraVideo = document.getElementById('cameraVideo');
        const actionBtn1 = document.getElementById('actionButton1');
        const actionBtn2 = document.getElementById('actionButton2');
        const quickActions = document.getElementById('quickActions');
        const headerTitle = document.getElementById('headerTitle');
        
        // ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========
        
        // –ü–µ—á–∞—Ç–∞–µ—Ç
        async function typeMessage(seconds = 1) {
            typingIndicator.classList.remove('hidden');
            await new Promise(resolve => setTimeout(resolve, seconds * 1000));
            typingIndicator.classList.add('hidden');
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
        function displayMessage(sender, text, isOwn = false, save = true, image = null) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isOwn ? 'own-message' : ''}`;
            
            const time = new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
            
            let avatarEmoji = 'üò∫';
            if (sender === '–®–ª—ë–ø–∞') avatarEmoji = 'üò∫';
            else if (sender === '–ë–∏–Ω–≥—É—Å') avatarEmoji = 'üòø';
            else if (sender === '–ü–æ–ø–∫—ç—Ç') avatarEmoji = 'üò∏';
            else if (sender === '–¢—ã') avatarEmoji = 'üë§';
            else if (sender === '–°–∏—Å—Ç–µ–º–∞') avatarEmoji = 'ü§ñ';
            
            let content = '';
            if (image) {
                content = `<img src="${image}" class="photo-message" onclick="enlargeImage(this)">`;
            } else {
                content = `<div class="message-text">${text}</div>`;
            }
            
            messageDiv.innerHTML = `
                ${!isOwn ? `<div class="message-avatar">${avatarEmoji}</div>` : ''}
                <div class="message-content">
                    <div class="message-name">${sender}</div>
                    ${content}
                    <div class="message-time">${time}</div>
                </div>
            `;
            
            chatEl.appendChild(messageDiv);
            chatEl.scrollTop = chatEl.scrollHeight;
            
            if (save) {
                gameState.messages.push({ sender, text, isOwn, time, image });
                saveGame();
            }
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–¥
        function showCode(code, language = 'python') {
            const codeDiv = document.createElement('div');
            codeDiv.className = 'code-block';
            codeDiv.innerHTML = `<pre>${code}</pre>`;
            chatEl.appendChild(codeDiv);
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ—Ç –¥–µ–Ω—å –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ
        function updateDay() {
            headerTitle.innerText = `–ò–Ω—Ñ–æ–ö–æ—Ç—ã ‚Ä¢ –î–µ–Ω—å ${gameState.day}`;
        }
        
        // –ì–ª—é–∫
        function glitch(intensity = 1) {
            document.body.classList.add('glitch-mode');
            gameState.glitchLevel += intensity;
            
            if (tg?.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('heavy');
            }
            
            setTimeout(() => {
           